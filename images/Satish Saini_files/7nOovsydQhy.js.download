if (self.CavalryLogger) { CavalryLogger.start_js(["HgAA0"]); }

__d("ActivityLogStory",["Event","Run","Toggler"],(function(a,b,c,d,e,f){"use strict";a={registerPopover:function(a){var c=b("Event").listen(window,"scroll",function(c){b("Toggler").hide(a)});b("Run").onLeave(c.remove.bind(c))}};e.exports=a}),null);
__d("AllActivityPeriod",["csx","CSS","DOM","MorePagerFetchOnScroll","Parent","TimelineSmartInsert","UIPagelet"],(function(a,b,c,d,e,f,g){var h=100;a=function(){"use strict";function a(a,c,d,e,f,g,h){this.$1=a,this.$2=!0,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$9=g,this.$10=!1,this.$11=h,this.$12=[],this.$7=b("DOM").scry(a,"div._z6j")[0]}var c=a.prototype;c.load=function(){if(this.$5)return;this.$5=!0;this.$7&&b("CSS").hide(this.$7);var a=b("Parent").byClass(this.$1,"fbTimelineSection");a&&b("CSS").show(a);var c=this.$1;function d(a){b("TimelineSmartInsert").run(c,a,h)}a=b("DOM").find(this.$1,"div.fbTimelineLogStream");this.$9.push(b("UIPagelet").loadFromEndpoint("TimelineEntStoryActivityLogPagelet",a.id,this.$4,{usePipe:!0,jsNonblock:!0,constHeight:!0,displayCallback:d,append:!0}))};c.contentAdded=function(a){if(!this.$10){var c=b("Parent").byClass(this.$1,"stat_elem");c&&b("CSS").removeClass(c,"async_saving");this.$7&&(a&&b("DOM").prependContent(this.$7,a),b("CSS").show(this.$7));this.$10=!0}};c.fullyLoaded=function(){if(!this.$10){var a=b("Parent").byClass(this.$1,"stat_elem");a&&b("CSS").removeClass(a,"async_saving");b("CSS").show(b("DOM").find(this.$1,"div._40pu"));this.$7&&b("CSS").hide(this.$7)}};c.activateScrollLoad=function(){this.$2=!0,this.$11[this.$3]&&this.$11[this.$3].reset()};c.deactivateScrollLoad=function(){if(!this.$5)this.$2=!1;else{var a=b("DOM").scry(this.$1,".uiMorePager");a&&a.map(function(a){a=b("MorePagerFetchOnScroll").getInstance(a.id);a&&a.removeEventListeners()})}this.$11[this.$3]&&this.$11[this.$3].remove()};c.getParentKey=function(){return this.$8};c.setParentKey=function(a){this.$8=a};c.getSubSections=function(){return this.$12};c.getScrubberKey=function(){return this.$3};c.getSortKey=function(){return this.$6};c.getLoaded=function(){return this.$5};c.getNode=function(){return this.$1};c.setSubSections=function(a){a&&(this.$12=a)};c.getCanScrollLoad=function(){return this.$2};return a}();e.exports=a}),null);
__d("AllActivitySections",[],(function(a,b,c,d,e,f){var g={},h=[];a={get:function(a){return Object.prototype.hasOwnProperty.call(g,a)?g[a]:null},getAll:function(){return g},remove:function(a){for(var b=0;b<h.length;b++)if(h[b]===a){h[b]=null;break}delete g[a]},removeAll:function(){g={}},set:function(a,b){g[a]=b}};e.exports=a}),null);
__d("AllActivityContentLoader",["AllActivityPeriod","AllActivitySections","Arbiter","DOMScroll","OnVisible","PageletSet","TimelineComponentKeys","TimelineConstants","TimelineController","Vector","$","clickRefAction"],(function(a,b,c,d,e,f){var g=!1,h=null,i={},j=[],k={},l=[],m=null;function n(){if(g)return;b("TimelineController").register(b("TimelineComponentKeys").CONTENT,p);b("clickRefAction")("scrubber").set_namespace("allactivity");g=!0}function o(a){a=b("AllActivitySections").get(a);a&&a.getCanScrollLoad()&&a.load()}var p={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(a,c,d,e,f,g,h){d===void 0&&(d={});e===void 0&&(e=!1);f===void 0&&(f="");g===void 0&&(g=0);h===void 0&&(h="");n();h&&b("PageletSet").hasPagelet(h)&&b("PageletSet").removePagelet(h);h=new(b("AllActivityPeriod"))(a,c,d,e,g,l,k);if(!f)j.push(c),i[c]=!0;else{h.setParentKey(f);a=b("AllActivitySections").get(f);a&&(a.getSubSections().push(h),a.getSubSections().sort(function(a,b){return b.getSortKey()-a.getSortKey()}))}b("AllActivitySections").set(c,h);p.checkCurrentSectionChange();b("Arbiter").inform(b("TimelineConstants").SECTION_REGISTERED,{scrubberKey:c},"persistent")},reset:function(){p.stopLoadingContent(),g=!1,b("AllActivitySections").removeAll(),h=null,i={},j=[],k={},l=[],m=null},stopLoadingContent:function(){for(var a in k)k[a]&&k[a].remove();for(var b=0;b<l.length;b++)l[b].cancel()},setContentHeader:function(a){m=a},checkCurrentSectionChange:function(){var a=p.getCurrentSection(),c=h&&h.getScrubberKey();if(a&&a.getScrubberKey()!==c){h=a;c=a.getScrubberKey();a=a.getParentKey();a||(a=c,c=null);b("TimelineController").sectionHasChanged(a,c)}},getCurrentSection:function(){var a={},c=b("AllActivitySections").getAll();for(var d in c){var e=c[d];if(!e.getLoaded())continue;var f=b("Vector").getElementPosition(e.getNode(),"viewport").y;f<p.CURRENT_SECTION_OFFSET&&(a[f]=e)}f=Math.max.apply(p,Object.keys(a).map(Number));e=f===-Infinity;if(!e)return a[f];else return null},enableScrollLoad:function(a,c,d){a=b("$")(a);c=p.getNextSectionKey(c);c&&(k[c]=new(b("OnVisible"))(a,o.bind(null,c),!1,d||1e3))},getNextSectionKey:function(a){var c=b("AllActivitySections").get(a);if(!c)return null;c=b("AllActivitySections").get(c.getParentKey());if(c){for(var d=0;d<c.getSubSections().length-1;d++)if(c.getSubSections()[d].getScrubberKey()===a)return c.getSubSections()[d+1].getScrubberKey();for(var d=0;d<j.length-d;d++)if(j[d]===c.getScrubberKey()){a=j[d+1];if(a){a=b("AllActivitySections").get(a);if(a&&a.getSubSections()){a=a.getSubSections()[0];if(a)return a.getScrubberKey()}}}}return null},navigateToSection:function(a){var c=b("AllActivitySections").get(a);if(!c)return;a=a;b("AllActivitySections").get(c.getParentKey())||(a=c.getSubSections()[0].getScrubberKey(),c=b("AllActivitySections").get(a));for(var d=0;d<j.length;d++){var e=b("AllActivitySections").get(j[d]);if(e){for(var f=0;f<e.getSubSections().length;f++){if(e.getSubSections()[f].getScrubberKey()===a)break;e.getSubSections()[f].deactivateScrollLoad()}f=c&&b("AllActivitySections").get(c.getParentKey());if(f&&e.getScrubberKey()===f.getScrubberKey())break}}c&&(c.activateScrollLoad(),c.load());p.adjustContentPadding();e=b("Vector").getScrollPosition().x;if(c){f=b("Vector").getElementPosition(c.getNode()).y;d=p.SCROLL_TO_OFFSET;b("DOMScroll").scrollTo(new(b("Vector"))(e,f-d,"document"))}},adjustContentPadding:function(){var a=b("$")("fbTimelineLogBody");a&&a instanceof HTMLElement&&(a.style.paddingBottom=b("Vector").getViewportDimensions().y-p.CURRENT_SECTION_OFFSET-p.HEADER_SCROLL_CUTOFF+"px")},sectionHasContent:function(a){a=b("AllActivitySections").get(a);a&&a.contentAdded(m);m=null},sectionFullyLoaded:function(a){a=b("AllActivitySections").get(a);a&&a.fullyLoaded()}};e.exports=p}),null);
__d("ActivityLogSearch",["CSS","DOM","Event","Input","Run"],(function(a,b,c,d,e,f){function a(a,c,d){var e=b("DOM").find(d,".inputtext");c=b("Event").listen(c,"click",function(){b("CSS").hide(a),b("CSS").show(d),e.focus()});b("Run").onLeave(c.remove.bind(c));c=b("Event").listen(e,"blur",function(){b("Input").getValue(e)||(b("CSS").hide(d),b("CSS").show(a))});b("Run").onLeave(c.remove.bind(c))}e.exports=a}),null);