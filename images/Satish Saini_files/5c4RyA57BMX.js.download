if (self.CavalryLogger) { CavalryLogger.start_js(["OsOI7"]); }

__d("AdsMediaPickerDialogQueryContext",["react"],(function(a,b,c,d,e,f){"use strict";var g;a=g||b("react");e.exports=a.createContext({hasQuery:!1})}),null);
__d("ChatTabPolicy",["BanzaiODS","ChatBehavior","ChatOptions","ChatSidebarDropdownConstants","CurrentUser","LogHistory","MercuryAssert","MercuryIDs","MercuryIgnoredBlockedParticipants.bs","MercuryThreadActions","MercuryThreadInfo","MercuryViewer","MessagingTag","MessengerState.bs","MessengerWebStgTypedLoggerLite","PresencePrivacy","ShortProfiles","killswitch"],(function(a,b,c,d,e,f){"use strict";var g=b("MercuryThreadActions").get(),h=new Set(["1579802578966277","881263441913087","506060876211905"]),i=b("LogHistory").getInstance("tab_policy"),j=function(a){b("MessengerWebStgTypedLoggerLite")&&b("MessengerWebStgTypedLoggerLite").log({event_name:"suppress_new_message",extra_data:{reason:a}})},k=function(){return b("ChatOptions").getSetting(b("ChatSidebarDropdownConstants").TURN_OFF_CHAT_TABS)!==void 0};e.exports={messageIsAllowed:function(a,c,d){if(k()&&b("ChatOptions").getSetting(b("ChatSidebarDropdownConstants").TURN_OFF_CHAT_TABS)){j("turn_off_chat_tab");return}var e=a.thread_id,f=c.message_id,l=b("MercuryIDs").getUserIDFromParticipantID(b("MercuryViewer").getID());b("MercuryAssert").isThreadID(e);b("MercuryAssert").isParticipantID(c.author);var m;if(b("MercuryThreadInfo").isMuted(a)){m={thread_id:e,message_id:f,mute_until:a.mute_until};i.log("message_thread_muted",JSON.stringify(m));if(!b("MercuryThreadInfo").areMentionsMuted(a)){if(!c.profile_ranges||!c.profile_ranges.some||!c.profile_ranges.some(function(a){return a.id===l})){i.log("message_mentions_viewer",JSON.stringify(m));j("mention_muted");return}}else{j("message_thread_muted");return}}if(a.read_only){m={thread_id:e,message_id:f};i.log("message_read_only",JSON.stringify(m));b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_read_only");j("message_read_only");return}if(c.source=="source:email"||c.source=="source:titan:emailreply"){m={thread_id:e,message_id:f,source:c.source};i.log("message_source_not_allowed",JSON.stringify(m));j("message_source_not_allowed");b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_source_not_allowed");return}var n=b("MercuryIDs").getUserIDFromParticipantID(c.author);if(!n){i.log("message_bad_author",JSON.stringify({thread_id:e,message_id:f,user:n}));j("message_bad_author");b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_bad_author");return}if(c.action_type!="ma-type:user-generated-message"&&!this._messageIsNewlyCreatedGroup(c,a)){m={thread_id:e,message_id:f,type:c.action_type};i.log("message_non_user_generated",JSON.stringify(m));j("message_non_user_generated");this._messageIsNewlyCreatedGroup(c,a)&&b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_non_user_generated_new_group_thread");return}if(a.is_canonical_user&&!b("ChatBehavior").notifiesUserMessages()){i.log("message_jabber",JSON.stringify({thread_id:e,message_id:f}));g.markSeen(e,!0);j("message_jabber");b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_jabber");return}if(a.is_canonical&&!a.other_user_fbid){i.log("message_canonical_contact",JSON.stringify({thread_id:e,message_id:f}));j("message_canonical_contact");b("BanzaiODS").bumpEntityKey(3303,"messenger-chat-tab-policy","message_canonical_contact");return}if(a.folder!=b("MessagingTag").INBOX){i.log("message_folder",JSON.stringify({thread_id:e,message_id:f,folder:a.folder}));j("message_no_inbox");return}var o=b("CurrentUser").getID();b("MessengerState.bs").compute(o,function(c){c=c.blocked_ids;if(b("MercuryIgnoredBlockedParticipants.bs").isPresentInGroupThread(o,c,a)){m={thread_id:e,message_id:f};i.log("message_blocked_participants",JSON.stringify(m));j("message_blocked_participants");return}if(l==null)return;b("ShortProfiles").getMulti([n,l],function(a){if(!k()&&!b("PresencePrivacy").allows(n)){i.log("message_privacy",JSON.stringify({thread_id:e,message_id:f,user:n}));j("message_privacy");return}var c=a[n].employee&&a[l].employee,g=b("CurrentUser").isWorkUser();if(!c&&!g&&!a[n].isCommercePage&&!h.has(n)&&a[n].type!=="friend"&&a[n].type!=="page"){i.log("message_non_friend",JSON.stringify({thread_id:e,message_id:f,user:n}));j("message_non_friend");return}if(b("killswitch")("MESSENGER_WEB_STOP_AUTOMATIC_CHAT_TAB_RAISING")){i.log("chat_tab_automatic_popup_killswitch",JSON.stringify({thread_id:e,message_id:f,user:n}));return}d()})})},_messageIsNewlyCreatedGroup:function(a,b){return a.action_type==="ma-type:log-message"&&a.log_message_type==="log:thread-name"&&b.message_count===1}}}),null);